<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Colaboradores</title>
 
</head>
<body>
    <h1>Cadastro de Colaboradores</h1>

 
    <form id="collaboratorForm">
        <h3>Inserir ou Atualizar Colaborador</h3>
        <label for="id">ID (para atualização):</label>
        <input type="number" id="id" name="id">
        <br><br>
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" required>
        <br><br>
        <label for="cpf">CPF:</label>
        <input type="text" id="cpf" name="cpf" required>
        <br><br>
        <label for="departamento">Departamento:</label>
        <input type="text" id="departamento" name="departamento" required>
        <br><br>
        <button type="submit">Enviar</button>
    </form>

    <h3>Lista de Colaboradores</h3>
    <ul id="collaborator-list"></ul>

    <script>
        const apiUrl = 'http://localhost:8080/colaboradores';

       
        async function listarColaboradores() {
            try {
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error(`Erro: ${response.status}`);
                const colaboradores = await response.json();

                const list = document.getElementById('collaborator-list');
                list.innerHTML = '';

                colaboradores.forEach(collab => {
                    const li = document.createElement('li');
                    li.textContent = `ID: ${collab.id} | Nome: ${collab.nome} | CPF: ${collab.cpf} | Departamento: ${collab.departamento}`;
                
                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Excluir';
                    deleteButton.onclick = () => excluirColaborador(collab.id);
                    li.appendChild(deleteButton);

                    // Botão de editar
                    const editButton = document.createElement('button');
                    editButton.textContent = 'Editar';
                    editButton.onclick = () => editarColaborador(collab);
                    li.appendChild(editButton);

                    list.appendChild(li);
                });
            } catch (error) {
                console.error('Erro ao listar colaboradores:', error);
            }
        }

   
        document.getElementById('collaboratorForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const id = document.getElementById('id').value;
            const nome = document.getElementById('nome').value;
            const cpf = document.getElementById('cpf').value;
            const departamento = document.getElementById('departamento').value;

            const colaborador = { nome, cpf, departamento };

            try {
                let response;
                if (id) {
             
                    response = await fetch(`${apiUrl}/${id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(colaborador)
                    });
                } else {
              
                    response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(colaborador)
                    });
                }

                if (!response.ok) throw new Error(`Erro: ${response.status}`);
                listarColaboradores();
                document.getElementById('collaboratorForm').reset();
            } catch (error) {
                console.error('Erro ao salvar colaborador:', error);
            }
        });

        async function excluirColaborador(id) {
            try {
                const response = await fetch(`${apiUrl}/${id}`, {
                    method: 'DELETE'
                });
                if (!response.ok) throw new Error(`Erro ao excluir: ${response.status}`);
                listarColaboradores();
            } catch (error) {
                console.error('Erro ao excluir colaborador:', error);
            }
        }

      
        function editarColaborador(collab) {
            document.getElementById('id').value = collab.id;
            document.getElementById('nome').value = collab.nome;
            document.getElementById('cpf').value = collab.cpf;
            document.getElementById('departamento').value = collab.departamento;
        }

        // Chama a função para listar colaboradores ao carregar a página
        window.onload = listarColaboradores;
    </script>
</body>
</html>
